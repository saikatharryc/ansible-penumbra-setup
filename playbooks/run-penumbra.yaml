---
- name: Run Nodes
  hosts: fullnode_3
  become: true
  vars:
    network_name: backbone
    node_index: "1"
    moniker: saikat
    public_ip: "{{ ansible_ssh_host }}"
    penumbra_wallet_phrase_secret: !vault |
      $ANSIBLE_VAULT;1.1;AES256
      30663235643431313335353334343161336636333162646662336164333930613536323337383166
      3234303636303539376638393538643937616232653538310a373763313033386462376366653864
      35623338323330313631663661336266336633363461623763346535313561386539313031333663
      3663346239643739610a616536396664393461323831366166336634363264366437336131656662
      66306164623664346130373238666439313663386131376536666532626564303634663165353838
      30666562376634303466666335323162336166346665623466663961633336663337326237613537
      34383161323763323933336638636363646165373134353065626231363563336530653337396535
      32343466613162333964393065353935616362666138613734343438343336396264343934363566
      38343530363763636461666430383235396466306230383138303737663132316531616334623638
      37353363646261643137396262613535646537646661623465396133323235373434633863383930
      39356230323461643637316434653832613037316236356437623638616233666135316338623137
      37353633643731633562
  tags:
    - fullnode
  roles:
    - ../roles/docker_base
    - ../roles/file_setup
    - ../roles/postgres
    - ../roles/penumbra
    - ../roles/cometbft

- name: Install Targets on fullnode
  hosts: fullnode_3
  become: true
  tags:
    - fullnode
    - monitoring
  roles:
    - ../roles/docker_base
    - ../roles/target

- name: Install Grafana & Prometheus
  hosts: monitoring_3
  become: true
  vars:
    alertmanager_smtp_password: !vault |-
      $ANSIBLE_VAULT;1.1;AES256
      38636534353062626665383230313363653336633363333439323333626665323466383437643161
      3730346633353638653064306336393837353666643561390a643766633230303638313035333961
      31613931616137313336363234396136616333376166373263323233326332613135326261653965
      3731316561323866320a316238363961386331633834343730633831636662326531376336663934
      6439
    alertmanager_smtp_host: "outlook.office365.com:587"
    alertmanager_smtp_user: "test@tt.tt"
    alertmanager_smtp_to_email: "noreply@tt.tt"
    alertmanager_smtp_from_email: "noreply@tt.tt"
  tags:
    - monitoring
  roles:
    - ../roles/docker_base
    - ../roles/target
    - ../roles/observer
